commonfields:
  id: Microsoft Management
  version: -1
name: Microsoft Management
display: Microsoft Management
category: Data Enrichment & Threat Intelligence
description: The Microsoft Management Activity API integration allows you to subscribe
  or unsubscribe to different audits, receive their content and fetch new content
  as incidents.
configuration:
- display: Authentication code
  name: auth_code
  defaultvalue: ""
  type: 4
  required: true
- display: Redirect URI
  name: redirect_uri
  defaultvalue: ""
  type: 0
  required: true
- display: Client Secret
  name: client_secret
  defaultvalue: ""
  type: 4
  required: true
- display: Client ID
  name: client_id
  defaultvalue: ""
  type: 0
  required: true
- display: Base URL
  name: base_url
  defaultvalue: https://manage.office.com/api/v1.0/
  type: 0
  required: false
- display: Trust any certificate (not secure)
  name: insecure
  defaultvalue: ""
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  defaultvalue: ""
  type: 8
  required: false
- display: First fetch start (minutes)
  name: first_fetch_delta
  defaultvalue: "1440"
  type: 0
  required: false
- display: Content types to fetch
  name: content_types_to_fetch
  defaultvalue: ""
  type: 16
  required: false
  options:
  - Audit.AzureActiveDirectory
  - Audit.Exchange
  - Audit.SharePoint
  - Audit.General
- display: Fetch incidents
  name: isFetch
  defaultvalue: ""
  type: 8
  required: false
- display: Incident type
  name: incidentType
  defaultvalue: ""
  type: 13
  required: false
- display: Record types to fetch
  name: record_types_filter
  defaultvalue: ""
  type: 0
  required: false
  additionalinfo: A comma separated list of the record types you wish to fetch. Content
    records with a record  type that isn't specified will not be fetched. If this
    field is left empty, all record types will be fetched.
- display: Workloads to fetch
  name: workloads_filter
  defaultvalue: ""
  type: 0
  required: false
  additionalinfo: A comma separated list of the workloads you wish to fetch. Content
    records with a workload that isn't specified will not be fetched. If this field
    is left empty, all workloads will be fetched.
- display: Operations to fetch
  name: operations_filter
  defaultvalue: ""
  type: 0
  required: false
  additionalinfo: A comma separated list of the operations you wish to fetch. Content
    records with an operation that isn't specified will not be fetched. If this field
    is left empty, all operations will be fetched.
script:
  script: ''
  type: python
  commands:
  - name: ms-management-activity-start-subscription
    arguments:
    - name: content_type
      required: true
      auto: PREDEFINED
      predefined:
      - Audit.AzureActiveDirectory
      - Audit.Exchange
      - Audit.SharePoint
      - Audit.General
      description: The content type to subscribe to.
    description: Starts a subscription to a given content type
  - name: ms-management-activity-stop-subscription
    arguments:
    - name: content_type
      required: true
      auto: PREDEFINED
      predefined:
      - Audit.AzureActiveDirectory
      - Audit.Exchange
      - Audit.SharePoint
      - Audit.General
      description: The content type to stop being subscribed to.
    description: Stops a subscription to a given content type
  - name: ms-management-activity-list-subscriptions
    arguments: []
    outputs:
    - contextPath: MicrosoftManagement.Subscription
      description: List of current subscriptions
      type: string
    description: List the content types you are currently subscribed to
  - name: ms-management-activity-list-content
    arguments:
    - name: content_type
      required: true
      auto: PREDEFINED
      predefined:
      - Audit.AzureActiveDirectory
      - Audit.Exchange
      - Audit.SharePoint
      - Audit.General
      description: The content type you wish to receive content of.
    - name: start_time
      description: 'The earliest time to get content from. If start_time is specified,
        end_time must be specified as well. The start_time must be before the end_time,
        can be at most 7 days ago, and has to be within 24 hours from end_time. Required
        format: YYYY-MM-DDTHH-MM-SS. If not specified, start time will be 24 hours
        ago.'
    - name: end_time
      description: 'The latest time to get content from. If end_time is specified,
        start_time must be specified as well. The start_time must be before the end_time
        and has to be within 24 hours from start_time. Required format: YYYY-MM-DDTHH-MM-SS.
        If not specified, end_time will be now.'
    - name: record_types_filter
      description: A comma separated list of the record types you wish to fetch. Content
        records with a record  type that isn't specified will not be fetched. If this
        field is left empty, all record types will be fetched.
    - name: workloads_filter
      description: A comma separated list of the workloads you wish to fetch. Content
        records with a workload that isn't specified will not be fetched. If this
        field is left empty, all workloads will be fetched.
    - name: operations_filter
      description: A comma separated list of the operations you wish to fetch. Content
        records with an operation that isn't specified will not be fetched. If this
        field is left empty, all operations will be fetched.
    outputs:
    - contextPath: MicrosoftManagement.ContentRecord.ID
      description: The ID of the record.
      type: number
    - contextPath: MicrosoftManagement.ContentRecord.CreationTime
      description: The creation time of the record.
      type: date
    - contextPath: MicrosoftManagement.ContentRecord.RecordType
      description: The type of the record.
      type: Unknown
    - contextPath: MicrosoftManagement.ContentRecord.Operation
      description: The operation described in the record.
      type: Unknown
    - contextPath: MicrosoftManagement.ContentRecord.UserType
      description: The type of the related user.
      type: string
    - contextPath: MicrosoftManagement.ContentRecord.OrganizationID
      description: The ID of the organization relevant to the record.
      type: number
    - contextPath: MicrosoftManagement.ContentRecord.UserKey
      description: The key of the related user.
      type: string
    - contextPath: MicrosoftManagement.ContentRecord.ClientIP
      description: The IP of the record's client.
      type: string
    - contextPath: MicrosoftManagement.ContentRecord.Scope
      description: The scope of the record.
      type: string
    - contextPath: MicrosoftManagement.ContentRecord.Workload
      description: The workload of the record.
      type: string
    - contextPath: MicrosoftManagement.ContentRecord.ResultsStatus
      description: The results status of the record.
      type: string
    - contextPath: MicrosoftManagement.ContentRecord.ObjectID
      description: The ID of the record's object.
      type: string
    - contextPath: MicrosoftManagement.ContentRecord.UserID
      description: The ID of the record's user.
      type: string
    description: Returns all content of a specific content type.
  dockerimage: demisto/pyjwt3:1.0.0.4946
  isfetch: true
  runonce: false
  subtype: python3
